function e(){this.m_DD_Make=null,this.m_DD_Model=null,this.m_DD_Variant=null,this.m_DD_Fuel=null,this.m_Submit=null,this.m_Form=null,this.m_OnSubmit=null,this.m_OnBeforeMakeChange=null,this.m_OnBeforeModelChange=null,this.m_OnBeforeFuelChange=null,this.m_ShowVehicleCallback=null,this.m_AllLoadedCallback=null,this.m_Lbl=new Array("- Please select -","- Please select above -",'Please <a href="http://browsehappy.com/">upgrade your browser</a>.'),this.m_DD_LastLoaded=null,this.m_DD_defaults={},this.m_EventListenersAdded=!1,this.m_xhr=null,this.init=function(){var e=this;this._ltIE9()?window.attachEvent("onload",function(){l_OldIENotSupported=document.createElement("p"),l_OldIENotSupported.innerHTML=e.m_Lbl[2],l_OldIENotSupported.className="etError",document.getElementById("etct_form").appendChild(l_OldIENotSupported)}):window.addEventListener("load",function(){e._init()},!1)},this.cancelXhr=function(){null!=this.m_xhr&&this.m_xhr.abort()},this.exe=function(e){var t=this,l={method:null,dropdown:null,onBefore:null,callback:null,data:null};for(l_i in l)"undefined"!=typeof e[l_i]&&(l[l_i]=e[l_i]);null==l.data&&(l.data=new FormData(this.m_Form));var a=l.data;a.append("etct_method",l.method),null!=l.onBefore&&l.onBefore(),this.m_xhr=new XMLHttpRequest,this.m_xhr.onreadystatechange=function(){if(4==t.m_xhr.readyState){if(200!=t.m_xhr.status&&304!=t.m_xhr.status)return void t.msg("Error "+t.m_xhr.status);if(l_Response=JSON.parse(t.m_xhr.responseText),null!=l.callback&&null!=l.callback)try{l.callback(l_Response)}catch(e){t.msg(e)}if(l_Response.Success){if(null!=l.dropdown)try{t._fillDD(l_Response,l.dropdown)}catch(e){t.msg(e)}}else null!=l_Response.ErrorMessage&&(l_Error=document.createElement("p"),l_Error.innerHTML=l_Response.ErrorMessage,l_Error.className="etError",t.m_Form.appendChild(l_Error));t.m_xhr=null}},this.m_xhr.open("POST","PHP/json.channel.php",!0),this.m_xhr.send(a)},this._init=function(e){var t=this,l={DD_Make:document.getElementById("etct_make"),DD_Model:document.getElementById("etct_model"),DD_Fuel:document.getElementById("etct_fuel"),DD_Variant:document.getElementById("etct_variant"),Submit:document.getElementById("etct_submit"),Form:document.getElementById("etct_form"),_Defaults:null};if("undefined"!=typeof e)for(l_Key in l)"undefined"!=typeof e[l_Key]&&(l[l_Key]=e[l_Key]);this.m_DD_Make=l.DD_Make,this.m_DD_Model=l.DD_Model,this.m_DD_Fuel=l.DD_Fuel,this.m_DD_Variant=l.DD_Variant,this.m_Submit=l.Submit,this.m_Form=l.Form,null==l._Defaults?(this._parseDefaultOption(this.m_DD_Make),this._parseDefaultOption(this.m_DD_Model),this._parseDefaultOption(this.m_DD_Fuel),this._parseDefaultOption(this.m_DD_Variant)):this.m_DD_defaults=l._Defaults,this.m_EventListenersAdded||(this.m_DD_Make.addEventListener("change",function(e){t._EvtDisp(e)},!1),this.m_DD_Model.addEventListener("change",function(e){t._EvtDisp(e)},!1),this.m_DD_Fuel.addEventListener("change",function(e){t._EvtDisp(e)},!1),this.m_DD_Variant.addEventListener("change",function(e){t._EvtDisp(e)},!1),this.m_Form.addEventListener("submit",function(e){t._EvtDisp(e)},!1),this.m_EventListenersAdded=!0),this.m_DD_Make.childNodes[0].innerHTML=this.m_Lbl[0],this.m_DD_Model.childNodes[0].innerHTML=this.m_Lbl[1],this.m_DD_Fuel.childNodes[0].innerHTML=this.m_Lbl[1],this.m_DD_Variant.childNodes[0].innerHTML=this.m_Lbl[1],this.Load(this.m_DD_Make,function(){t.m_DD_Model.setAttribute("disabled",1)})},this.Load=function(e){var t=this;this.m_Submit.setAttribute("disabled",1),this.exe({method:e.getAttribute("data-method"),dropdown:e,onBefore:function(){e.setAttribute("disabled",!0)},callback:function(){e.removeAttribute("disabled"),t.m_DD_LastLoaded=e}})},this.ShowVehicle=function(e){var t=this;this.exe({method:"vehicle",onBefore:function(){t.m_Submit.setAttribute("disabled",!0)},callback:function(e){if(t.m_Submit.removeAttribute("disabled"),null!=t.m_ShowVehicleCallback)try{t.m_ShowVehicleCallback(e)}catch(l){t.msg(l)}}}),"undefined"!=typeof e&&e.preventDefault()},this.OnMakeChange=function(){if(0!=this.m_DD_Make.selectedIndex){if(null!=this.m_OnBeforeMakeChange)try{this.m_OnBeforeMakeChange()}catch(e){this.msg(e)}this.Load(this.m_DD_Model)}else this.m_DD_Model.selectedIndex=0,this.m_DD_Model.setAttribute("disabled",1);this.m_DD_Fuel.selectedIndex=0,this.m_DD_Fuel.setAttribute("disabled",1),this.m_DD_Variant.selectedIndex=0,this.m_DD_Variant.setAttribute("disabled",1)},this.OnModelChange=function(){if(0!=this.m_DD_Model.selectedIndex){if(null!=this.m_OnBeforeModelChange)try{this.m_OnBeforeModelChange()}catch(e){this.msg(e)}this.Load(this.m_DD_Fuel)}else this.m_DD_Fuel.selectedIndex=0,this.m_DD_Fuel.setAttribute("disabled",1);this.m_DD_Variant.selectedIndex=0,this.m_DD_Variant.setAttribute("disabled",1)},this.OnFuelChange=function(){if(0!=this.m_DD_Fuel.selectedIndex){if(null!=this.m_OnBeforeFuelChange)try{this.m_OnBeforeFuelChange()}catch(e){this.msg(e)}this.Load(this.m_DD_Variant)}else this.m_DD_Variant.selectedIndex=0,this.m_DD_Variant.setAttribute("disabled",1)},this.OnVariantChange=function(){if("-1"!=this.m_DD_Variant.childNodes[this.m_DD_Variant.selectedIndex].value){if(this.m_Submit.removeAttribute("disabled"),null!=this.m_AllLoadedCallback)try{this.m_AllLoadedCallback()}catch(e){this.msg(e)}}else this.m_Submit.setAttribute("disabled",1)},this._EvtDisp=function(e){e.target==this.m_DD_Make&&this.OnMakeChange(e),e.target==this.m_DD_Model&&this.OnModelChange(e),e.target==this.m_DD_Fuel&&this.OnFuelChange(e),e.target==this.m_DD_Variant&&this.OnVariantChange(e),e.target==this.m_Form&&(null==this.m_OnSubmit?this.ShowVehicle(e):this.m_OnSubmit(e))},this.msg=function(e){console.log("ET",e)},this._fillDD=function(e,t){for(var l=null;t.firstChild;)t.removeChild(t.firstChild);for(l_i in e.Items)l=document.createElement("option"),l.value=e.Items[l_i].Value,l.innerHTML=e.Items[l_i].Text,t.appendChild(l);this._preselectOption(t)},this._ltIE9=function(){return l_test=/msie.[0-9]/.test(window.navigator.userAgent.toLowerCase()),"undefined"!=typeof l_test?l_test:!1},this._preselectOption=function(e){var t=this.m_DD_defaults[e.getAttribute("name")];if("undefined"!=typeof t){for(l_i in e.childNodes)if(e.childNodes[l_i].value==t){e.childNodes[l_i].setAttribute("selected",!0);break}setTimeout(function(){var t=new CustomEvent("change",{bubbles:!0});e.dispatchEvent(t)},100)}delete this.m_DD_defaults[e.getAttribute("name")]},this._parseDefaultOption=function(e){if(-1!=window.location.href.indexOf(e.getAttribute("name"))){var t=window.location.search.substr(1).split("&");for(l_i in t){var l=t[l_i].split("=");if(l[0]==e.getAttribute("name")){this.m_DD_defaults[e.getAttribute("name")]=l[1];break}}}}}function t(){this.m_lastCar=null,this.m_originalPlaceholderImage="",this.m_DarkArea=null,this.init=function(){this.m_originalPlaceholderImage=document.getElementById("etct_VehicleModelImageUrl").getAttribute("src");var e=document.getElementById("etct_rq_form").getElementsByTagName("input");for(l_i in e)"object"==typeof e[l_i]&&e[l_i].addEventListener("change",a.dismissErrors,!1);this.m_DarkArea=document.createElement("div"),this.m_DarkArea.className="etDarkArea",this.m_DarkArea.style.display="none",this.m_DarkArea.style.height=window.innerHeight,document.getElementsByTagName("body")[0].appendChild(this.m_DarkArea),document.getElementById("etct_close_request").addEventListener("click",this.closeDialog,!1),document.getElementById("etct_close_result").addEventListener("click",this.closeDialog,!1),document.getElementById("etct_showRequestQuote").addEventListener("click",function(){document.getElementById("etct_result").style.display="none",document.getElementById("etct_requestQuote").style.display="block"},!1)},this.closeDialog=function(){i.cancelXhr(),document.getElementById("etct_result").style.display="none",document.getElementById("etct_requestQuote").style.display="none",a.m_DarkArea.style.display="none"},this.autoload=function(e){l.m_DD_LastLoaded==l.m_DD_Variant&&setTimeout(function(){l.ShowVehicle(e),window.removeEventListener("etct_method_loaded",a.autoload)},100)},this.removeStagesAndVariants=function(){var e=document.getElementById("etct_AvailableStages");if(null!=e)for(;e.firstChild;)e.removeChild(e.firstChild);document.getElementById("etct_DpfRemovalAvailable").setAttribute("disabled",!0),document.getElementById("etct_EgrRemovalAvailable").setAttribute("disabled",!0),document.getElementById("etct_VMaxRemovalAvailable").setAttribute("disabled",!0),document.getElementById("etct_RevLimiterRemovalAvailable").setAttribute("disabled",!0),document.getElementById("etct_LaunchControlAvailable").setAttribute("disabled",!0)},this.dismissErrors=function(){try{var e=document.querySelector(".etError");null!=e&&e.parentNode.removeChild(e)}catch(t){console.log(t)}},this.submitRequestForm=function(e){a.dismissErrors();var t=new FormData(document.getElementById("etct_rq_form"));l.exe({method:"request",data:t,onBefore:function(){document.getElementById("etct_requestSubmit").setAttribute("disabled",!0)},callback:function(e){document.getElementById("etct_requestSubmit").removeAttribute("disabled");var t=document.createElement("p");e.Successful?(document.getElementById("etct_rq_form").style.display="none",t.innerHTML="Request sent - we will reply as soon as possible. Thank you!",t.className="etNotice"):("undefined"!=typeof e.ErrorMessage&&(t.innerHTML=e.ErrorMessage),"undefined"!=typeof e.ValidationErrors&&(t.innerHTML=e.ValidationErrors.join("<br>")),t.className="etError"),document.getElementById("etct_requestQuote").appendChild(t)}}),e.stopPropagation(),e.preventDefault()},this.fillVehicleProperties=function(){var e=null,t=null;document.getElementById("etct_VehicleModelImageUrl").setAttribute("src",this.m_originalPlaceholderImage);var l=document.getElementById("etct_AvailableStages");document.getElementById("etct_carCompleteString").value=this.m_lastCar.MakeName+", "+this.m_lastCar.ModelName+", "+this.m_lastCar.Fuel+", "+this.m_lastCar.VariantName;try{var a=document.querySelector(".etNotice")[0];a.parentNode.removeChild(a)}catch(i){}if(null!=l)for(;l.firstChild;)l.removeChild(l.firstChild);var n=document.getElementById("etct_TuningStages");if(null!=n)for(;n.firstChild;)n.removeChild(n.firstChild);var d=document.getElementById("etct_stageTabs");if(null!=d)for(;d.firstChild;)d.removeChild(d.firstChild);document.getElementById("etct_DpfRemovalAvailable_Display").className="etSprite "+(this.m_lastCar.DpfRemovalAvailable?"etAvailable":"etUnavailable"),document.getElementById("etct_EgrRemovalAvailable_Display").className="etSprite "+(this.m_lastCar.EgrRemovalAvailable?"etAvailable":"etUnavailable"),document.getElementById("etct_RevLimiterRemovalAvailable_Display").className="etSprite "+(this.m_lastCar.RevLimiterRemovalAvailable?"etAvailable":"etUnavailable"),document.getElementById("etct_VMaxRemovalAvailable_Display").className="etSprite "+(this.m_lastCar.VMaxRemovalAvailable?"etAvailable":"etUnavailable"),document.getElementById("etct_LaunchControlAvailable_Display").className="etSprite "+(this.m_lastCar.LaunchControlAvailable?"etAvailable":"etUnavailable");var r=document.createElement("table"),s=document.createElement("thead"),o=document.createElement("tr"),m=document.createElement("th");m.innerHTML="Tuning Stage";var c=document.createElement("th");c.innerHTML="Power ("+this.m_lastCar.StandardPowerUnit+")";var u=document.createElement("th");u.innerHTML="Torque ("+this.m_lastCar.StandardTorqueUnit+")";var _=document.createElement("th");_.innerHTML="Select";var h=document.createElement("tbody");o.appendChild(m),o.appendChild(c),o.appendChild(u),o.appendChild(_),s.appendChild(o),r.appendChild(s),r.appendChild(h);for(key in this.m_lastCar){var f=document.getElementById("etct_"+key);if(null!=f)if("string"==typeof this.m_lastCar[key]||"number"==typeof this.m_lastCar[key])if("VehicleModelImageUrl"==key)null!=this.m_lastCar[key]&&""!=this.m_lastCar[key]&&f.setAttribute("src",this.m_lastCar[key]);else try{var g=this.m_lastCar[key];"StandardPower"==key&&(g+=" "+this.m_lastCar.StandardPowerUnit),"StandardTorque"==key&&(g+=" "+this.m_lastCar.StandardTorqueUnit),f.innerHTML=g}catch(i){console.warn("Could not fill this element: "+key)}else if("boolean"==typeof this.m_lastCar[key])"checkbox"==f.getAttribute("type")&&(this.m_lastCar[key]?f.removeAttribute("disabled"):f.setAttribute("disabled",!0));else if("object"==typeof this.m_lastCar[key]&&"TuningStages"==key)for(l_i in this.m_lastCar[key]){e=null,t=null;var y=document.getElementById("etct_template_stage").cloneNode(!0);y.removeAttribute("id");for(l_ts_key in this.m_lastCar[key][l_i]){if("TuningStageId"==l_ts_key){var p=document.createElement("input");p.name="TuningStageId",p.type="radio",p.value=this.m_lastCar[key][l_i][l_ts_key],p.setAttribute("data-title",this.m_lastCar[key][l_i].TuningStageTitle),p.addEventListener("change",function(e){document.getElementById("etct_stageName").value=e.target.getAttribute("data-title")},!1),this.m_lastCar[key][l_i].DefaultStage&&(document.getElementById("etct_stageName").value=this.m_lastCar[key][l_i].TuningStageTitle,p.setAttribute("checked","checked"));var D=document.createElement("tr"),b=document.createElement("td");b.innerHTML=this.m_lastCar[key][l_i].TuningStageTitle;var v=document.createElement("td");v.innerHTML=this.m_lastCar[key][l_i].ModifiedPower;var E=document.createElement("td");E.innerHTML=this.m_lastCar[key][l_i].ModifiedTorque;var C=document.createElement("td");C.appendChild(p),D.appendChild(b),D.appendChild(v),D.appendChild(E),D.appendChild(C),h.appendChild(D)}else{var k=y.querySelector(".etct_"+l_ts_key);if(null!=k){var g=this.m_lastCar[key][l_i][l_ts_key];("ModifiedPower"==l_ts_key||"StandardPower"==l_ts_key)&&(g+=" "+this.m_lastCar[key][l_i].ModifiedPowerUnit),("ModifiedTorque"==l_ts_key||"StandardTorque"==l_ts_key)&&(g+=" "+this.m_lastCar[key][l_i].ModifiedTorqueUnit),k.innerHTML=g}}"ModifiedPower"==l_ts_key&&(y.querySelector(".etct_PowerGain").innerHTML=this.m_lastCar[key][l_i][l_ts_key]-this.m_lastCar.StandardPower+" "+this.m_lastCar[key][l_i].ModifiedPowerUnit),"ModifiedTorque"==l_ts_key&&(y.querySelector(".etct_TorqueGain").innerHTML=this.m_lastCar[key][l_i][l_ts_key]-this.m_lastCar.StandardTorque+" "+this.m_lastCar[key][l_i].ModifiedTorqueUnit)}var I=this.m_lastCar[key][l_i].VideoUrl;if("undefined"!=typeof I&&""!=I&&null!=I&&-1==I.indexOf("embed"))if(-1!=I.indexOf("watch")){var A=I.split("watch?v=")[1].split("&")[0];I="//www.youtube.com/embed/"+A}else if(-1!=I.indexOf("youtu.be")){var A=I.split(".be/")[1].split("?")[0];I="//www.youtube.com/embed/"+A}else I=null;"undefined"!=typeof I&&""!=I&&null!=I&&(t=document.createElement("a"),t.setAttribute("href",I),t.innerHTML='&nbsp;&nbsp;<span class="etSprite etVideo"></span> Video',t.addEventListener("click",function(e){e.target.getAttribute("href");document.getElementById("etct_result").style.display="none";var t=document.createElement("div");t.className="etLightbox";var l=document.createElement("a");l.className="etRight etClose",l.innerHTML="&times;",l.addEventListener("click",function(e){try{var t=e.target.parentNode;t.parentNode.removeChild(t)}catch(l){console.log("removing the lightbox has failed!")}document.getElementById("etct_result").style.display="block",e.preventDefault()},!1),t.appendChild(l);var a=document.createElement("div");t.appendChild(a);try{var i=document.createElement("iframe");i.setAttribute("width","100%"),i.setAttribute("height","500"),i.setAttribute("frameborder","0"),i.setAttribute("allowfullscreen","true"),i.setAttribute("src",I),t.appendChild(i)}catch(n){console.log("could not add YT iframe "+n)}document.getElementsByTagName("body")[0].appendChild(t),e.preventDefault()},!1));var B=this.m_lastCar[key][l_i].DynoChartUrl;if("undefined"!=typeof B&&""!=B&&null!=B&&(e=document.createElement("a"),e.setAttribute("href",B),e.innerHTML='<span class="etSprite etChart"></span> Chart',e.addEventListener("click",function(e){var t=e.target.getAttribute("href");document.getElementById("etct_result").style.display="none";var l=document.createElement("div");l.className="etLightbox";var a=document.createElement("a");a.className="etRight etClose",a.innerHTML="&times;",a.addEventListener("click",function(e){try{var t=e.target.parentNode;t.parentNode.removeChild(t)}catch(l){console.log("removing the lightbox has failed!")}document.getElementById("etct_result").style.display="block",e.preventDefault()},!1),l.appendChild(a);var i=document.createElement("div");l.appendChild(i);var n=document.createElement("img");n.setAttribute("width","100%"),n.setAttribute("height","auto"),n.setAttribute("src",t),l.appendChild(n),document.getElementsByTagName("body")[0].appendChild(l),e.preventDefault()},!1)),null!=e||null!=t){var M=document.createElement("tfoot"),S=document.createElement("tr"),L=document.createElement("td");L.setAttribute("colspan",4),null!=e&&L.appendChild(e),null!=t&&L.appendChild(t),S.appendChild(L),M.appendChild(S),y.querySelector("table").appendChild(M)}document.getElementById("etct_TuningStages").appendChild(y);var w=document.createElement("a");w.innerHTML=this.m_lastCar[key][l_i].TuningStageTitle,w.setAttribute("href","#");var T=document.createElement("li");T.appendChild(w),"undefined"!=typeof this.m_lastCar[key][l_i].DefaultStage&&1==this.m_lastCar[key][l_i].DefaultStage&&(T.className="on",y.style.display="block"),w.addEventListener("click",function(e){var t=0;for(l_i in e.target.parentNode.parentNode.childNodes){if(e.target.parentNode.parentNode.childNodes[l_i]==e.target.parentNode)break;t++}var l=document.getElementById("etct_stageTabs").childNodes;for(l_i in l)l[l_i].className="";e.target.parentNode.className="on";var a=document.getElementById("etct_TuningStages").childNodes;for(l_i1 in a)"object"==typeof a[l_i1]&&(a[l_i1].style.display="none");null!=document.getElementById("etct_TuningStages").childNodes[t]&&(document.getElementById("etct_TuningStages").childNodes[t].style.display="block"),e.preventDefault()}),document.getElementById("etct_stageTabs").appendChild(T)}}if(document.getElementById("etct_AvailableStages").appendChild(r),document.getElementById("etct_result").style.display="block",l_toYear=(new Date).getFullYear(),null!=this.m_lastCar.VariantToYear&&(l_toYear=parseInt(this.m_lastCar.VariantToYear)),null!=document.getElementById("etct_vehicleYear"))for(;document.getElementById("etct_vehicleYear").firstChild;)document.getElementById("etct_vehicleYear").removeChild(document.getElementById("etct_vehicleYear").firstChild);for(l_year=this.m_lastCar.VariantFromYear;l_toYear>l_year;l_year++){var N=document.createElement("option");N.setAttribute("value",l_year),N.innerHTML=l_year,document.getElementById("etct_vehicleYear").appendChild(N)}document.getElementById("etct_rq_form").style.display="block",this.m_DarkArea.style.display="block"}}!function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var l=document.createEvent("CustomEvent");return l.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),l}e.prototype=window.Event.prototype,window.CustomEvent=e}();var l;l=new e,l.init();var a=null,i=null;a=new t,"undefined"!=typeof l&&(l._ltIE9()||window.addEventListener("load",function(){var t=null;i=new e,a.init(),null!=document.getElementById("etct_result")?(l.m_ShowVehicleCallback=function(e){t={makeId:document.getElementById("etct_make").childNodes[document.getElementById("etct_make").selectedIndex].value,modelId:document.getElementById("etct_model").childNodes[document.getElementById("etct_model").selectedIndex].value,fuelId:document.getElementById("etct_fuel").childNodes[document.getElementById("etct_fuel").selectedIndex].value,variantId:document.getElementById("etct_variant").childNodes[document.getElementById("etct_variant").selectedIndex].value},a.m_lastCar=e,a.fillVehicleProperties(),i._init({DD_Make:document.getElementById("etct_sr_make"),DD_Model:document.getElementById("etct_sr_model"),DD_Fuel:document.getElementById("etct_sr_fuel"),DD_Variant:document.getElementById("etct_sr_variant"),Submit:document.getElementById("etct_requestSubmit"),Form:document.getElementById("etct_rq_form"),_Defaults:t}),i.m_OnBeforeMakeChange=a.removeStagesAndVariants,i.m_OnBeforeModelChange=a.removeStagesAndVariants,i.m_OnBeforeFuelChange=a.removeStagesAndVariants,i.m_OnSubmit=a.submitRequestForm,i.m_ShowVehicleCallback=function(e){a.m_lastCar=e,a.fillVehicleProperties()},i.m_AllLoadedCallback=function(){i.ShowVehicle()}},-1!=window.location.pathname.indexOf("/detail.htm")&&window.addEventListener("etct_method_loaded",a.autoload)):l.m_ShowVehicleCallback=function(){window.location.href="detail.htm?"+l.m_DD_Make.getAttribute("name")+"="+l.m_DD_Make.childNodes[l.m_DD_Make.selectedIndex].value+"&"+l.m_DD_Model.getAttribute("name")+"="+l.m_DD_Model.childNodes[l.m_DD_Model.selectedIndex].value+"&"+l.m_DD_Variant.getAttribute("name")+"="+l.m_DD_Variant.childNodes[l.m_DD_Variant.selectedIndex].value+"&"+l.m_DD_Fuel.getAttribute("name")+"="+l.m_DD_Fuel.childNodes[l.m_DD_Fuel.selectedIndex].value+"#etct_result"}},!1));
//# sourceMappingURL=https://emotion-tuning.com/SDK/js/etctApi.min.map