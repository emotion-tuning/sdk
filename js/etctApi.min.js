function e(){this.m_DD_Make=null,this.m_DD_Model=null,this.m_DD_Variant=null,this.m_DD_Fuel=null,this.m_Submit=null,this.m_Form=null,this.m_ShowVehicleCallback=null,this.m_Lbl=new Array("- Please select -","- Please select above -",'Please <a href="http://browsehappy.com/">upgrade your browser</a>.'),this.m_DD_LastLoaded=null,this.m_DD_defaults={},this.init=function(){this._ltIE9()?window.attachEvent("onload",function(){l_OldIENotSupported=document.createElement("p"),l_OldIENotSupported.innerHTML=i.m_Lbl[2],l_OldIENotSupported.className="etError",document.getElementById("etct_form").appendChild(l_OldIENotSupported)}):window.addEventListener("load",this._OnDocLoad,!1)},this.exe=function(e){var t={method:null,dropdown:null,onBefore:null,callback:null,data:null};for(l_i in t)"undefined"!=typeof e[l_i]&&(t[l_i]=e[l_i]);null==t.data&&(t.data=new FormData(this.m_Form));var l=null,n=t.data;n.append("etct_method",t.method),null!=t.onBefore&&t.onBefore(),l=new XMLHttpRequest,l.onreadystatechange=function(){if(4==l.readyState){if(200!=l.status&&304!=l.status)return void i.msg("Error "+l.status);if(l_Response=JSON.parse(l.responseText),null!=t.callback)try{t.callback(l_Response)}catch(e){i.msg(e)}if(l_Response.Success){if(null!=t.dropdown)try{i._fillDD(l_Response,t.dropdown)}catch(e){i.msg(e)}}else null!=l_Response.ErrorMessage&&(l_Error=document.createElement("p"),l_Error.innerHTML=l_Response.ErrorMessage,l_Error.className="etError",i.m_Form.appendChild(l_Error))}},l.open("POST","PHP/json.channel.php",!0),l.send(n)},this._OnDocLoad=function(){i._init()},this._init=function(){this.m_DD_Make=document.getElementById("etct_make"),this.m_DD_Model=document.getElementById("etct_model"),this.m_DD_Fuel=document.getElementById("etct_fuel"),this.m_DD_Variant=document.getElementById("etct_variant"),this.m_Submit=document.getElementById("etct_submit"),this.m_Form=document.getElementById("etct_form"),this.m_DD_Make.addEventListener("change",this._EvtDisp,!1),this.m_DD_Model.addEventListener("change",this._EvtDisp,!1),this.m_DD_Fuel.addEventListener("change",this._EvtDisp,!1),this.m_DD_Variant.addEventListener("change",this._EvtDisp,!1),this.m_Form.addEventListener("submit",this._EvtDisp,!1),this._parseDefaultOption(this.m_DD_Make),this._parseDefaultOption(this.m_DD_Model),this._parseDefaultOption(this.m_DD_Fuel),this._parseDefaultOption(this.m_DD_Variant),this.m_DD_Make.childNodes[0].innerHTML=this.m_Lbl[0],this.m_DD_Model.childNodes[0].innerHTML=this.m_Lbl[1],this.m_DD_Fuel.childNodes[0].innerHTML=this.m_Lbl[1],this.m_DD_Variant.childNodes[0].innerHTML=this.m_Lbl[1],this.Load(this.m_DD_Make)},this.Load=function(e){this.m_Submit.setAttribute("disabled",1),this.exe({method:e.getAttribute("data-method"),dropdown:e,onBefore:function(){e.setAttribute("disabled",!0)},callback:function(){e.removeAttribute("disabled"),i.m_DD_LastLoaded=e;var t=new CustomEvent("etct_method_loaded",{bubbles:!0});window.dispatchEvent(t)}})},this.ShowVehicle=function(e){var t=this;this.exe({method:"vehicle",onBefore:function(){t.m_Submit.setAttribute("disabled",!0)},callback:function(e){t.m_Submit.removeAttribute("disabled"),t.m_ShowVehicleCallback(e)}}),e.preventDefault()},this.OnMakeChange=function(){this.Load(this.m_DD_Model),this.m_DD_Fuel.selectedIndex=0,this.m_DD_Fuel.setAttribute("disabled",1),this.m_DD_Variant.selectedIndex=0,this.m_DD_Variant.setAttribute("disabled",1)},this.OnModelChange=function(){this.Load(this.m_DD_Fuel),this.m_DD_Variant.selectedIndex=0,this.m_DD_Variant.setAttribute("disabled",1)},this.OnFuelChange=function(){this.Load(this.m_DD_Variant)},this.OnVariantChange=function(){"-1"!=this.m_DD_Variant.childNodes[this.m_DD_Variant.selectedIndex].value?this.m_Submit.removeAttribute("disabled"):this.m_Submit.setAttribute("disabled",1)},this._EvtDisp=function(e){e.target==i.m_DD_Make&&i.OnMakeChange(e),e.target==i.m_DD_Model&&i.OnModelChange(e),e.target==i.m_DD_Fuel&&i.OnFuelChange(e),e.target==i.m_DD_Variant&&i.OnVariantChange(e),e.target==i.m_Form&&i.ShowVehicle(e)},this.msg=function(e){console.log("ET",e)},this._fillDD=function(e,t){for(var i=null;t.firstChild;)t.removeChild(t.firstChild);for(l_i in e.Items)i=document.createElement("option"),i.value=e.Items[l_i].Value,i.innerHTML=e.Items[l_i].Text,t.appendChild(i);this._preselectOption(t)},this._ltIE9=function(){return l_test=/msie.[0-9]/.test(window.navigator.userAgent.toLowerCase()),"undefined"!=typeof l_test?l_test:!1},this._preselectOption=function(e){var t=this.m_DD_defaults[e.getAttribute("name")];if("undefined"!=typeof t){for(l_i in e.childNodes)if(e.childNodes[l_i].value==t){e.childNodes[l_i].setAttribute("selected",!0);break}setTimeout(function(){var t=new CustomEvent("change",{bubbles:!0});e.dispatchEvent(t)},100)}delete this.m_DD_defaults[e.getAttribute("name")]},this._parseDefaultOption=function(e){if(-1!=window.location.href.indexOf(e.getAttribute("name"))){var t=window.location.search.substr(1).split("&");for(l_i in t){var i=t[l_i].split("=");if(i[0]==e.getAttribute("name")){this.m_DD_defaults[e.getAttribute("name")]=i[1];break}}}}}function t(){this.m_lastCar=null,this.m_originalPlaceholderImage="",this.init=function(){this.m_originalPlaceholderImage=document.getElementById("etct_VehicleModelImageUrl").getAttribute("src"),document.getElementById("etct_rq_form").addEventListener("submit",l.submitRequestForm,!1);var e=document.getElementById("etct_rq_form").getElementsByTagName("input");for(l_i in e)"object"==typeof e[l_i]&&e[l_i].addEventListener("change",l.dismissErrors,!1)},this.autoload=function(e){i.m_DD_LastLoaded==i.m_DD_Variant&&setTimeout(function(){i.ShowVehicle(e),window.removeEventListener("etct_method_loaded",l.autoload)},100)},this.dismissErrors=function(){try{var e=document.querySelector(".etError");null!=e&&e.parentNode.removeChild(e)}catch(t){console.log(t)}},this.submitRequestForm=function(e){l.dismissErrors();var t=new FormData(document.getElementById("etct_rq_form"));t.append("variantId",i.m_DD_Variant.childNodes[i.m_DD_Variant.selectedIndex].value),t.append("tuningStageId",document.querySelector('input[name="TuningStageId"]:checked').value),t.append("dpfRemoval",document.getElementById("etct_DpfRemovalAvailable").checked),t.append("vmaxRemoval",document.getElementById("etct_VMaxRemovalAvailable").checked),t.append("egrRemoval",document.getElementById("etct_EgrRemovalAvailable").checked),t.append("revLimiterRemoval",document.getElementById("etct_RevLimiterRemovalAvailable").checked),t.append("launchControl",document.getElementById("etct_LaunchControlAvailable").checked),i.exe({method:"request",data:t,onBefore:function(){document.getElementById("etct_requestSubmit").setAttribute("disabled",!0)},callback:function(e){document.getElementById("etct_requestSubmit").removeAttribute("disabled");var t=document.createElement("p");e.Successful?(document.getElementById("etct_rq_form").style.display="none",t.innerHTML="Request sent - we will reply as soon as possible. Thank you!",t.className="etNotice"):(t.innerHTML=e.ValidationErrors.join("<br>"),t.className="etError"),document.getElementById("etct_requestQuote").appendChild(t)}}),e.preventDefault()},this.fillVehicleProperties=function(){document.getElementById("etct_VehicleModelImageUrl").setAttribute("src",this.m_originalPlaceholderImage);for(var e=document.getElementById("etct_TuningStages");e.firstChild;)e.removeChild(e.firstChild);for(key in this.m_lastCar){var t=document.getElementById("etct_"+key);if(null!=t)if("string"==typeof this.m_lastCar[key]||"number"==typeof this.m_lastCar[key])if("VehicleModelImageUrl"==key)null!=this.m_lastCar[key]&&""!=this.m_lastCar[key]&&t.setAttribute("src",this.m_lastCar[key]);else try{t.innerHTML=this.m_lastCar[key]}catch(i){console.warn("Could not fill this element: "+key)}else if("boolean"==typeof this.m_lastCar[key])"checkbox"==t.getAttribute("type")&&(this.m_lastCar[key]?t.removeAttribute("disabled"):t.setAttribute("disabled",!0));else if("object"==typeof this.m_lastCar[key]&&"TuningStages"==key)for(l_i in this.m_lastCar[key]){var l=document.getElementById("etct_template_stage").cloneNode(!0);l.removeAttribute("id"),l.style.display="block";for(l_ts_key in this.m_lastCar[key][l_i]){if("TuningStageId"==l_ts_key)l.querySelector(".etct_TuningStageId").value=this.m_lastCar[key][l_i][l_ts_key];else{var n=l.querySelector(".etct_"+l_ts_key);null!=n&&(n.innerHTML=this.m_lastCar[key][l_i][l_ts_key])}"boolean"==typeof this.m_lastCar[key][l_i][l_ts_key]&&"DefaultStage"==l_ts_key&&this.m_lastCar[key][l_i][l_ts_key]&&l.querySelector(".etct_StageSelector").setAttribute("checked",!0),"ModifiedPower"==l_ts_key&&(l.querySelector(".etct_PowerGain").innerHTML=this.m_lastCar[key][l_i][l_ts_key]-this.m_lastCar.StandardPower),"ModifiedTorque"==l_ts_key&&(l.querySelector(".etct_TorqueGain").innerHTML=this.m_lastCar[key][l_i][l_ts_key]-this.m_lastCar.StandardTorque)}document.getElementById("etct_TuningStages").appendChild(l)}}for(document.getElementById("etct_result").style.display="block",l_toYear=(new Date).getFullYear(),null!=this.m_lastCar.VariantToYear&&(l_toYear=parseInt(this.m_lastCar.VariantToYear));document.getElementById("etct_vehicleYear").firstChild;)document.getElementById("etct_vehicleYear").removeChild(document.getElementById("etct_vehicleYear").firstChild);for(l_year=this.m_lastCar.VariantFromYear;l_toYear>l_year;l_year++){var a=document.createElement("option");a.setAttribute("value",l_year),a.innerHTML=l_year,document.getElementById("etct_vehicleYear").appendChild(a)}document.getElementById("etct_requestQuote").style.display="block",document.getElementById("etct_rq_form").style.display="block"}}!function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i}e.prototype=window.Event.prototype,window.CustomEvent=e}();var i;i=new e,i.init();var l=null;l=new t,"undefined"!=typeof i&&(i._ltIE9()||window.addEventListener("load",function(){null!=document.getElementById("etct_result")?(i.m_ShowVehicleCallback=function(e){l.m_lastCar=e,l.fillVehicleProperties()},l.init(),-1!=window.location.pathname.indexOf("/detail.htm")&&window.addEventListener("etct_method_loaded",l.autoload)):i.m_ShowVehicleCallback=function(){window.location.href="detail.htm?"+i.m_DD_Make.getAttribute("name")+"="+i.m_DD_Make.childNodes[i.m_DD_Make.selectedIndex].value+"&"+i.m_DD_Model.getAttribute("name")+"="+i.m_DD_Model.childNodes[i.m_DD_Model.selectedIndex].value+"&"+i.m_DD_Variant.getAttribute("name")+"="+i.m_DD_Variant.childNodes[i.m_DD_Variant.selectedIndex].value+"&"+i.m_DD_Fuel.getAttribute("name")+"="+i.m_DD_Fuel.childNodes[i.m_DD_Fuel.selectedIndex].value+"#etct_result"}},!1));
//# sourceMappingURL=https://emotion-tuning.com/SDK/js/etctApi.min.map